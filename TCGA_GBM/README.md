
## TCGA Glioblastome dataset

Data set for cola analysis. The original source is from [https://gdc.cancer.gov/about-data/publications/gbm_exp](https://tcga-data.nci.nih.gov/docs/publications/gbm_exp/).

- [TCGA_unified_CORE_ClaNC840.txt](https://jokergoo.github.io/cola_examples/TCGA_GBM/TCGA_unified_CORE_ClaNC840.txt)
- [unifiedScaled.txt](https://jokergoo.github.io/cola_examples/TCGA_GBM/unifiedScaled.txt)

RDS files generated by cola (use `readRDS()` to load into R (>= 3.6.0)):

- [TCGA_GBM_subgroup.rds](https://jokergoo.github.io/cola_examples/TCGA_GBM/TCGA_GBM_subgroup.rds)

HTML reports for cola analysis:

- [TCGA_GBM_subgroup_cola_report](https://jokergoo.github.io/cola_examples/TCGA_GBM/TCGA_GBM_subgroup_cola_report/cola_report.html)

Following code performs the analysis.

Prepare the input matrix:

```r
library(cola)
library(RColorBrewer)

m = read.table("unifiedScaled.txt", header = TRUE, row.names = 1, check.names = FALSE)
m = as.matrix(m)

subtype = read.table("TCGA_unified_CORE_ClaNC840.txt", sep = "\t", header = TRUE, 
    check.names = FALSE, stringsAsFactors = FALSE)
subtype = structure(unlist(subtype[1, -(1:2)]), names = colnames(subtype)[-(1:2)])
subtype_col = structure(seq_len(4), names = unique(subtype))

m = m[, names(subtype)]
m = adjust_matrix(m)
```

Perform the consensus partitioning:

```r
register_NMF()

set.seed(123)
rl = run_all_consensus_partition_methods(
    m,
    mc.cores = 4,
    anno = data.frame(subtype = subtype),
    anno_col = list(subtype = subtype_col)
)
saveRDS(rl, file = "TCGA_GBM_subgroup.rds")
cola_report(rl, output_dir = "TCGA_GBM_subgroup_cola_report", mc.cores = 4)
```
