 
## Golub leukemia dataset

[The Golub leukemia dataset](https://bioconductor.org/packages/release/data/experiment/html/golubEsets.html) is a Bioconductor dataset.

RDS files generated by cola (use `readRDS()` to load into R (>= 3.6.0)):

- [Golub_leukemia_subgroup.rds](https://jokergoo.github.io/cola_examples/Golub_leukemia/Golub_leukemia_subgroup.rds)

HTML reports for cola analysis:

- [Golub_leukemia_subgroup_cola_report](https://jokergoo.github.io/cola_examples/Golub_leukemia/Golub_leukemia_subgroup_cola_report/cola_report.html)
Following code performs the analysis.

Prepare the input matrix:

```r
library(cola)

library(golubEsets)
data(Golub_Merge)
m = exprs(Golub_Merge)
colnames(m) = paste0("sample_", colnames(m))
anno = pData(Golub_Merge)

m[m <= 1] = NA
m = log10(m)

m = adjust_matrix(m)

library(preprocessCore)
cn = colnames(m)
rn = rownames(m)
m = normalize.quantiles(m)
colnames(m) = cn
rownames(m) = rn
```

Perform the consensus partitioning:

```r
register_NMF()

set.seed(123)
rl = run_all_consensus_partition_methods(
    m,
    mc.cores = 4, 
    anno = anno[, c("ALL.AML"), drop = FALSE],
    anno_col = c("ALL" = "red", "AML" = "blue")
)
saveRDS(rl, file = qq("Golub_leukemia_subgroup.rds"))
cola_report(rl, output_dir = "Golub_leukemia_subgroup_cola_report", mc.cores = 4)
```
